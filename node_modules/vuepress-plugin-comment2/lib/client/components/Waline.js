import{useLocaleConfig as e}from"@mr-hope/vuepress-shared/lib/client";import{usePageFrontmatter as l,usePageLang as t}from"@vuepress/client";import{defineComponent as n,computed as o,onMounted as a,onBeforeUnmount as i,watch as r,nextTick as s,h as m}from"vue";import{useRoute as u}from"vue-router";import"../styles/waline.scss";const c=COMMENT_OPTIONS,p=Boolean(c&&"waline"===c.type&&c.serverURL),v=WALINE_LOCALES;var d=n({name:"WalineComment",setup(){const n=u(),d=l(),h=t(),w=e(v);let f,g=null;const j=o((()=>{if(!p)return!1;const e=!1!==c.comment,l=d.value.comment;return Boolean(l)||!1!==e&&!1!==l})),y=o((()=>{if(!p)return!1;const e=!1!==c.pageviews,l=d.value.pageview;return Boolean(l)||!1!==e&&!1!==l})),C=()=>{const e=f=(new Date).getTime();g?setTimeout((()=>{e===f&&g.update({lang:"zh-CN"===h.value?"zh-CN":"en",locale:{...w.value,...c.locale||{}}})}),c.delay):Promise.all([import("@waline/client"),new Promise((e=>{setTimeout(e,c.delay)}))]).then((([{default:l}])=>{e===f&&(g=l({lang:"zh-CN"===h.value?"zh-CN":"en",locale:{...w.value,...c.locale||{}},emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili"],dark:"html.dark",...c,el:"#waline-comment",visitor:y.value}))}))};return a((()=>{p&&C()})),i((()=>{g&&g.destroy()})),r((()=>n.path),(()=>s().then((()=>C())))),()=>m("div",{class:"waline-wrapper",style:{display:j.value?"block":"none"},innerHTML:'<div id="waline-comment" />'})}});export{d as default};
//# sourceMappingURL=Waline.js.map
